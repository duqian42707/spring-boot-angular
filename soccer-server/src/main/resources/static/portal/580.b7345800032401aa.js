"use strict";(self.webpackChunkportal=self.webpackChunkportal||[]).push([[580],{6580:(ct,Q,c)=>{c.r(Q),c.d(Q,{SysModule:()=>A});var q=c(7629),D=c(9132),t=c(4650),l=c(9094),u=c(5791),E=c(3478),U=c(6858),J=c(1971);const R=["st"],Y=function(){return{toTop:!1}};class f{constructor(e,n){this.http=e,this.modal=n,this.url="/user",this.searchSchema={properties:{no:{type:"string",title:"\u7f16\u53f7"}}},this.columns=[{title:"\u7f16\u53f7",index:"no"},{title:"\u8c03\u7528\u6b21\u6570",type:"number",index:"callNo"},{title:"\u5934\u50cf",type:"img",width:"50px",index:"avatar"},{title:"\u65f6\u95f4",type:"date",index:"updatedAt"},{title:"",buttons:[]}]}ngOnInit(){}add(){}}f.\u0275fac=function(e){return new(e||f)(t.Y36(l.lP),t.Y36(l.Te))},f.\u0275cmp=t.Xpm({type:f,selectors:[["app-sys-log"]],viewQuery:function(e,n){if(1&e&&t.Gf(R,5),2&e){let s;t.iGM(s=t.CRH())&&(n.st=s.first)}},decls:5,vars:5,consts:[["mode","search",3,"schema","formSubmit","formReset"],[3,"data","page","columns"],["st",""]],template:function(e,n){if(1&e){const s=t.EpF();t._UZ(0,"page-header"),t.TgZ(1,"nz-card")(2,"sf",0),t.NdJ("formSubmit",function(r){t.CHM(s);const a=t.MAs(4);return t.KtG(a.reset(r))})("formReset",function(r){t.CHM(s);const a=t.MAs(4);return t.KtG(a.reset(r))}),t.qZA(),t._UZ(3,"st",1,2),t.qZA()}2&e&&(t.xp6(2),t.Q6J("schema",n.searchSchema),t.xp6(1),t.Q6J("data",n.url)("page",t.DdM(4,Y))("columns",n.columns))},dependencies:[u.kJ,E.q,U.A5,J.bd],encapsulation:2});var N=c(5156),w=c(9651),F=c(6895),h=c(6616),g=c(7044),y=c(1811),k=c(5681);function L(o,e){1&o&&t._UZ(0,"nz-spin",4)}function O(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.close())}),t._uU(4,"\u5173\u95ed"),t.qZA(),t.TgZ(5,"button",9),t.NdJ("click",function(){t.CHM(n);const i=t.MAs(1),r=t.oxw();return t.KtG(r.save(i.value))}),t._uU(6,"\u4fdd\u5b58"),t.qZA()()()}if(2&o){const n=t.MAs(1),s=t.oxw();t.Q6J("schema",s.schema)("ui",s.ui)("formData",s.i),t.xp6(5),t.Q6J("disabled",!n.valid)("nzLoading",s.http.loading)}}class p{constructor(e,n,s){this.modal=e,this.msgSrv=n,this.http=s,this.record={},this.schema={properties:{no:{type:"string",title:"\u7f16\u53f7"},owner:{type:"string",title:"\u59d3\u540d",maxLength:15},callNo:{type:"number",title:"\u8c03\u7528\u6b21\u6570"},href:{type:"string",title:"\u94fe\u63a5",format:"uri"},description:{type:"string",title:"\u63cf\u8ff0",maxLength:140}},required:["owner","callNo","href","description"]},this.ui={"*":{spanLabelFixed:100,grid:{span:12}},$no:{widget:"text"},$href:{widget:"string"},$description:{widget:"textarea",grid:{span:24}}}}ngOnInit(){this.record.id>0&&this.http.get(`/user/${this.record.id}`).subscribe(e=>this.i=e)}save(e){this.http.post(`/user/${this.record.id}`,e).subscribe(n=>{this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(!0)})}close(){this.modal.destroy()}}p.\u0275fac=function(e){return new(e||p)(t.Y36(N.Lf),t.Y36(w.dD),t.Y36(l.lP))},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-sys-user-edit"]],decls:5,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.qZA()(),t.YNc(3,L,1,0,"nz-spin",2),t.YNc(4,O,7,5,"sf",3)),2&e&&(t.xp6(2),t.hij("\u7f16\u8f91 ",n.record.id," \u4fe1\u606f"),t.xp6(1),t.Q6J("ngIf",!n.i),t.xp6(1),t.Q6J("ngIf",n.i))},dependencies:[F.O5,u.kJ,h.ix,g.w,y.dQ,k.W],encapsulation:2});const G=["st"];function H(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.add())}),t._uU(1,"\u65b0\u5efa"),t.qZA()}}const K=function(){return{total:"data.total",list:"data.list"}},$=function(o){return{reName:o}};class S{constructor(e,n){this.http=e,this.modal=n,this.url="/api/user/list",this.searchSchema={properties:{no:{type:"string",title:"\u7f16\u53f7"}}},this.columns=[{title:"\u7f16\u53f7",type:"no"},{title:"\u8d26\u53f7",index:"account"},{title:"\u6635\u79f0",index:"nickName"},{title:"\u5934\u50cf",type:"img",width:"64px",index:"avatarUrl"},{title:"\u65f6\u95f4",type:"date",index:"updatedAt"},{title:"\u64cd\u4f5c",buttons:[{text:"\u7f16\u8f91",type:"modal",modal:{component:p},click:"reload"}]}]}ngOnInit(){}add(){this.modal.createStatic(p,{i:{id:0}}).subscribe(()=>this.st.reload())}}function B(o,e){1&o&&t._UZ(0,"nz-spin",4)}function P(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.close())}),t._uU(4,"\u5173\u95ed"),t.qZA(),t.TgZ(5,"button",9),t.NdJ("click",function(){t.CHM(n);const i=t.MAs(1),r=t.oxw();return t.KtG(r.save(i.value))}),t._uU(6,"\u4fdd\u5b58"),t.qZA()()()}if(2&o){const n=t.MAs(1),s=t.oxw();t.Q6J("schema",s.schema)("ui",s.ui)("formData",s.i),t.xp6(5),t.Q6J("disabled",!n.valid)("nzLoading",s.http.loading)}}S.\u0275fac=function(e){return new(e||S)(t.Y36(l.lP),t.Y36(l.Te))},S.\u0275cmp=t.Xpm({type:S,selectors:[["app-sys-user"]],viewQuery:function(e,n){if(1&e&&t.Gf(G,5),2&e){let s;t.iGM(s=t.CRH())&&(n.st=s.first)}},decls:7,vars:8,consts:[[3,"action"],["phActionTpl",""],["mode","search",3,"schema","formSubmit","formReset"],[3,"data","res","columns"],["st",""],["nz-button","","nzType","primary",3,"click"]],template:function(e,n){if(1&e){const s=t.EpF();t.TgZ(0,"page-header",0),t.YNc(1,H,2,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(3,"nz-card")(4,"sf",2),t.NdJ("formSubmit",function(r){t.CHM(s);const a=t.MAs(6);return t.KtG(a.reset(r))})("formReset",function(r){t.CHM(s);const a=t.MAs(6);return t.KtG(a.reset(r))}),t.qZA(),t._UZ(5,"st",3,4),t.qZA()}if(2&e){const s=t.MAs(2);t.Q6J("action",s),t.xp6(4),t.Q6J("schema",n.searchSchema),t.xp6(1),t.Q6J("data",n.url)("res",t.VKq(6,$,t.DdM(5,K)))("columns",n.columns)}},dependencies:[u.kJ,E.q,U.A5,h.ix,g.w,y.dQ,J.bd],encapsulation:2});class d{constructor(e,n,s){this.modal=e,this.msgSrv=n,this.http=s,this.record={},this.schema={properties:{roleValue:{type:"string",title:"\u89d2\u8272\u6807\u8bc6"},roleName:{type:"string",title:"\u89d2\u8272\u540d\u79f0"}},required:["roleName","roleValue"]},this.ui={"*":{spanLabelFixed:100,grid:{span:24}},$roleValue:{widget:"string"},$roleName:{widget:"string"}}}ngOnInit(){console.log("init edit",this.record),null!=this.record.roleId&&this.http.get(`/api/role/info/${this.record.roleId}`).subscribe(e=>this.i=e.data)}save(e){this.http.post(null!=this.record.roleId?"/api/role/update":"/api/role/insert",e).subscribe(s=>{this.msgSrv.success(s.msg),this.modal.close(!0)})}close(){this.modal.destroy()}}d.\u0275fac=function(e){return new(e||d)(t.Y36(N.Lf),t.Y36(w.dD),t.Y36(l.lP))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-sys-role-edit"]],decls:5,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.qZA()(),t.YNc(3,B,1,0,"nz-spin",2),t.YNc(4,P,7,5,"sf",3)),2&e&&(t.xp6(2),t.hij("\u7f16\u8f91 ",n.record.id," \u4fe1\u606f"),t.xp6(1),t.Q6J("ngIf",!n.i),t.xp6(1),t.Q6J("ngIf",n.i))},dependencies:[F.O5,u.kJ,h.ix,g.w,y.dQ,k.W],encapsulation:2});const X=["st"];function j(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"button",5),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.add())}),t._uU(1,"\u65b0\u5efa"),t.qZA()}}const W=function(){return{total:"data.total",list:"data.list"}},tt=function(o){return{reName:o}};class x{constructor(e,n){this.http=e,this.modal=n,this.loading=null,this.url="/api/role/list",this.searchSchema={properties:{roleName:{type:"string",title:"\u89d2\u8272\u540d\u79f0"},roleValue:{type:"string",title:"\u89d2\u8272\u6807\u8bc6"}}},this.columns=[{title:"\u7f16\u53f7",type:"no"},{title:"\u89d2\u8272\u6807\u8bc6",index:"roleValue"},{title:"\u89d2\u8272\u540d\u79f0",index:"roleName"},{title:"\u66f4\u65b0\u4eba",index:"lastModifiedBy",format:s=>function V(o){return null!=o&&o.includes("~~~")?o.split("~~~")[1]:o}(s.lastModifiedBy)},{title:"\u66f4\u65b0\u65f6\u95f4",type:"date",index:"lastModifiedDate"},{title:"\u64cd\u4f5c",buttons:[{text:"\u7f16\u8f91",type:"modal",modal:{component:d},click:"reload"},{text:"\u5220\u9664",type:"del",click:s=>this.delete(s)}]}]}ngOnInit(){}add(){this.modal.createStatic(d,{i:{roleId:null}}).subscribe(()=>this.st.reload())}delete(e){this.loading=!0,this.http.post(`/api/role/delete/${e.roleId}`).subscribe(n=>{this.loading=null,this.st.reload()})}}function et(o,e){1&o&&t._UZ(0,"nz-spin",4)}function nt(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.close())}),t._uU(4,"\u5173\u95ed"),t.qZA(),t.TgZ(5,"button",9),t.NdJ("click",function(){t.CHM(n);const i=t.MAs(1),r=t.oxw();return t.KtG(r.save(i.value))}),t._uU(6,"\u4fdd\u5b58"),t.qZA()()()}if(2&o){const n=t.MAs(1),s=t.oxw();t.Q6J("schema",s.schema)("ui",s.ui)("formData",s.i),t.xp6(5),t.Q6J("disabled",!n.valid)("nzLoading",s.http.loading)}}x.\u0275fac=function(e){return new(e||x)(t.Y36(l.lP),t.Y36(l.Te))},x.\u0275cmp=t.Xpm({type:x,selectors:[["app-sys-role"]],viewQuery:function(e,n){if(1&e&&t.Gf(X,5),2&e){let s;t.iGM(s=t.CRH())&&(n.st=s.first)}},decls:7,vars:9,consts:[[3,"action"],["phActionTpl",""],["mode","search",3,"schema","formSubmit","formReset"],[3,"data","loading","res","columns"],["st",""],["nz-button","","nzType","primary",3,"click"]],template:function(e,n){if(1&e){const s=t.EpF();t.TgZ(0,"page-header",0),t.YNc(1,j,2,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(3,"nz-card")(4,"sf",2),t.NdJ("formSubmit",function(r){t.CHM(s);const a=t.MAs(6);return t.KtG(a.reset(r))})("formReset",function(r){t.CHM(s);const a=t.MAs(6);return t.KtG(a.reset(r))}),t.qZA(),t._UZ(5,"st",3,4),t.qZA()}if(2&e){const s=t.MAs(2);t.Q6J("action",s),t.xp6(4),t.Q6J("schema",n.searchSchema),t.xp6(1),t.Q6J("data",n.url)("loading",n.loading)("res",t.VKq(7,tt,t.DdM(6,W)))("columns",n.columns)}},dependencies:[u.kJ,E.q,U.A5,h.ix,g.w,y.dQ,J.bd],encapsulation:2});class m{constructor(e,n,s){this.modal=e,this.msgSrv=n,this.http=s,this.record={},this.schema={properties:{menuName:{type:"string",title:"\u83dc\u5355\u540d\u79f0",maxLength:15},menuCode:{type:"string",title:"\u83dc\u5355\u7f16\u7801"}},required:["menuName","menuCode"]},this.ui={"*":{spanLabelFixed:100,grid:{span:24}},$menuName:{widget:"string"}}}ngOnInit(){}save(e){this.http.post(`/user/${this.record.id}`,e).subscribe(n=>{this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(!0)})}close(){this.modal.destroy()}}m.\u0275fac=function(e){return new(e||m)(t.Y36(N.Lf),t.Y36(w.dD),t.Y36(l.lP))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-sys-menu-edit"]],decls:5,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2),t.qZA()(),t.YNc(3,et,1,0,"nz-spin",2),t.YNc(4,nt,7,5,"sf",3)),2&e&&(t.xp6(2),t.hij("\u7f16\u8f91 ",n.record.id," \u4fe1\u606f"),t.xp6(1),t.Q6J("ngIf",!n.i),t.xp6(1),t.Q6J("ngIf",n.i))},dependencies:[F.O5,u.kJ,h.ix,g.w,y.dQ,k.W],encapsulation:2});var _=c(6675);function ot(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.add())}),t._uU(1,"\u65b0\u5efa"),t.qZA()}}function st(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"tr")(1,"td",8),t.NdJ("nzExpandChange",function(i){t.CHM(n);const r=t.oxw().$implicit;return t.KtG(r.expand=i)})("nzExpandChange",function(i){t.CHM(n);const r=t.oxw().$implicit,a=t.oxw().$implicit,I=t.oxw();return t.KtG(I.collapse(I.mapOfExpandedData[a.menuId],r,i))}),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td")(10,"a",9),t.NdJ("click",function(){t.CHM(n);const i=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.edit(i))}),t._uU(11,"\u7f16\u8f91"),t.qZA(),t.TgZ(12,"a",10),t.NdJ("click",function(){t.CHM(n);const i=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.delete(i))}),t._uU(13,"\u5220\u9664"),t.qZA()()()}if(2&o){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("nzIndentSize",20*n.level)("nzShowExpand",!!n.children&&n.children.length>0)("nzExpand",n.expand),t.xp6(1),t.hij(" ",n.menuName," "),t.xp6(2),t.Oqu(n.menuCode),t.xp6(2),t.Oqu(n.link),t.xp6(2),t.Oqu(n.icon)}}function it(o,e){if(1&o&&(t.ynx(0),t.YNc(1,st,14,7,"tr",7),t.BQk()),2&o){const n=e.$implicit;t.xp6(1),t.Q6J("ngIf",n.parent&&n.parent.expand||!n.parent)}}function rt(o,e){if(1&o&&(t.ynx(0),t.YNc(1,it,2,1,"ng-container",5),t.BQk()),2&o){const n=e.$implicit,s=t.oxw();t.xp6(1),t.Q6J("ngForOf",s.mapOfExpandedData[n.menuId])}}class T{constructor(e,n){this.http=e,this.modal=n,this.url="/user",this.searchSchema={properties:{no:{type:"string",title:"\u7f16\u53f7"}}},this.loading=!1,this.listOfMapData=[],this.mapOfExpandedData={}}ngOnInit(){this.queryTree()}queryTree(){this.loading=!0,this.http.get("/api/menu/tree").subscribe(e=>{this.listOfMapData=e.data,this.listOfMapData.forEach(n=>{this.mapOfExpandedData[n.menuId]=this.convertTreeToList(n)}),this.loading=!1})}collapse(e,n,s){if(!s){if(!n.children)return;n.children.forEach(i=>{const r=e.find(a=>a.menuId===i.menuId);r.expand=!1,this.collapse(e,r,!1)})}}convertTreeToList(e){const n=[],s=[],i={};for(n.push({...e,level:0,expand:!1});0!==n.length;){const r=n.pop();if(this.visitNode(r,i,s),r.children)for(let a=r.children.length-1;a>=0;a--)n.push({...r.children[a],level:r.level+1,expand:!1,parent:r})}return s}visitNode(e,n,s){n[e.menuId]||(n[e.menuId]=!0,s.push(e))}add(){this.modal.createStatic(m,{i:{menuId:null}}).subscribe(()=>this.queryTree())}search(e){this.queryTree()}reset(e){this.queryTree()}edit(e){this.modal.createStatic(m,{i:e}).subscribe(()=>this.queryTree())}delete(e){}}T.\u0275fac=function(e){return new(e||T)(t.Y36(l.lP),t.Y36(l.Te))},T.\u0275cmp=t.Xpm({type:T,selectors:[["app-sys-menu"]],decls:21,vars:5,consts:[[3,"action"],["phActionTpl",""],["mode","search",3,"schema","formSubmit","formReset"],["nzTableLayout","fixed",3,"nzLoading","nzData"],["expandTable",""],[4,"ngFor","ngForOf"],["nz-button","","nzType","primary",3,"click"],[4,"ngIf"],[3,"nzIndentSize","nzShowExpand","nzExpand","nzExpandChange"],["nz-button","","nzType","link",3,"click"],["nz-button","","nzType","link","nzDanger","",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"page-header",0),t.YNc(1,ot,2,0,"ng-template",null,1,t.W1O),t.qZA(),t.TgZ(3,"nz-card")(4,"sf",2),t.NdJ("formSubmit",function(i){return n.search(i)})("formReset",function(i){return n.reset(i)}),t.qZA(),t.TgZ(5,"nz-table",3,4)(7,"thead")(8,"tr")(9,"th"),t._uU(10,"\u83dc\u5355\u540d\u79f0"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"\u83dc\u5355\u7f16\u7801"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"\u94fe\u63a5"),t.qZA(),t.TgZ(15,"th"),t._uU(16,"\u56fe\u6807"),t.qZA(),t.TgZ(17,"th"),t._uU(18,"\u64cd\u4f5c"),t.qZA()()(),t.TgZ(19,"tbody"),t.YNc(20,rt,2,1,"ng-container",5),t.qZA()()()),2&e){const s=t.MAs(2),i=t.MAs(6);t.Q6J("action",s),t.xp6(4),t.Q6J("schema",n.searchSchema),t.xp6(1),t.Q6J("nzLoading",n.loading)("nzData",n.listOfMapData),t.xp6(15),t.Q6J("ngForOf",i.data)}},dependencies:[F.sg,F.O5,u.kJ,E.q,h.ix,g.w,y.dQ,J.bd,_.N8,_.Uo,_._C,_.h7,_.Om,_.p0,_.$Z],encapsulation:2});const at=[{path:"user",component:S},{path:"role",component:x},{path:"menu",component:T},{path:"log",component:f}];class C{}C.\u0275fac=function(e){return new(e||C)},C.\u0275mod=t.oAB({type:C}),C.\u0275inj=t.cJS({imports:[D.Bz.forChild(at),D.Bz]});class b{constructor(e){this.http=e}}b.\u0275fac=function(e){return new(e||b)(t.LFG(l.lP))},b.\u0275prov=t.Yz7({token:b,factory:b.\u0275fac});class v{constructor(e){this.http=e}}v.\u0275fac=function(e){return new(e||v)(t.LFG(l.lP))},v.\u0275prov=t.Yz7({token:v,factory:v.\u0275fac});class M{constructor(e){this.http=e}}M.\u0275fac=function(e){return new(e||M)(t.LFG(l.lP))},M.\u0275prov=t.Yz7({token:M,factory:M.\u0275fac});class z{constructor(e){this.http=e}}z.\u0275fac=function(e){return new(e||z)(t.LFG(l.lP))},z.\u0275prov=t.Yz7({token:z,factory:z.\u0275fac});class Z{constructor(e){this.http=e}}Z.\u0275fac=function(e){return new(e||Z)(t.LFG(l.lP))},Z.\u0275prov=t.Yz7({token:Z,factory:Z.\u0275fac});class A{}A.\u0275fac=function(e){return new(e||A)},A.\u0275mod=t.oAB({type:A}),A.\u0275inj=t.cJS({providers:[b,v,M,z,Z],imports:[q.m8,C]})}}]);